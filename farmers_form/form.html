<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farming Details Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="form.css">
    <link rel="icon" type="image/x-icon" href="khetbaari image.png">
</head>
<body>
    <!-- Farmer Info Form Section -->
    <div class="form-container">
      <h2>Fill Your Farming Details</h2>
      <form class="farmer-form" onsubmit="return submitForm()">
        
        <!-- Farmer Name -->
        <div class="form-group">
          <label for="farmer-name">Full Name</label>
          <input type="text" id="farmer-name" placeholder="Enter your full name" required>
        </div>
        
        <!-- Personal Info Row: Gender and Age -->
        <div class="personal-info-row">
          <div class="form-group half">
            <label for="gender">Gender</label>
            <select id="gender" required>
              <option value="">Select Gender</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="form-group half">
            <label for="dob">Date of Birth (DOB)</label>
            <input type="date" id="dob" required>
            <small class="hint">Enter the DOB in AD</small>
          </div>
        </div>

        <!-- Krishi ID -->
        <div class="form-group">
          <label for="krishi-id">Krishi / Agri ID (if available)</label>
          <input type="text" id="krishi-id" placeholder="Enter your Krishi ID">
        </div>

        <!-- Phone -->
        <div class="form-group">
          <label for="phone">Phone Number</label>
          <div class="phone-input">
            <span class="country-code">+977</span>
            <input type="tel" id="phone" placeholder="98XXXXXXXX" pattern="[9][6-8][0-9]{8}" required>
          </div>
          <small class="hint">Enter a valid 10-digit Nepali number starting with 96/97/98</small>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">Email</label>
          <div class="email-input">
            <input type="email" id="email" name="email" placeholder="example123@gmail.com" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required/>
          </div>
          <small class="hint">Please enter a valid email address</small>
        </div>

        <!-- Preferred Contact Method -->
        <div class="form-group">
          <label for="contact-method">Preferred Contact Method</label>
          <select id="contact-method" required>
            <option value="">Select your preferred method</option>
            <option value="phone">Phone Number</option>
            <option value="email">Email</option>
          </select>
          <small class="hint">We‚Äôll use this method to reach out for updates or support</small>
        </div>


        <!-- Profile Picture Upload -->
        <div class="form-group">
          <label for="profile-pic">Upload Profile Picture</label>
          <input type="file" id="profile-pic" accept="image/*" required>
          <small class="hint">Accepted formats: JPG, PNG, JPEG. Max size: 5MB</small>
        </div>

        <!-- Permanent Address -->
        <div class="form-group">
          <label for="address">Permanent Address</label>
          <div class="location-input">
            <input type="text" id="address" placeholder="Municipality/VDC, District, Province, Country" required>
            <button type="button" class="loc-btn" onclick="getCurrentLocation('address')">üìç Use My Location</button>
          </div>
        </div>

        <!-- Temporary Address -->
        <div class="form-group">
          <label for="temp-address">Temporary Address</label>
          <div class="checkbox-wrapper" style="margin-bottom: 10px;">
            <input type="checkbox" id="same-address">
            <label for="same-address">Same as permanent address</label>
          </div>
          <div class="location-input">
            <input type="text" id="temp-address" placeholder="Municipality/VDC, District, Province, Country" required>
            <button type="button" class="loc-btn" onclick="getCurrentLocation('temp-address')">üìç Use My Location</button>
          </div>
        </div>
        

        <!-- Land Ownership -->
        <div class="form-group">
          <label for="land">Landholding Size</label>
          <div class="land-units">
            <input type="number" id="bigha" min="0" placeholder="Bigha">
            <input type="number" id="kattha" min="0" placeholder="Kattha">
            <input type="number" id="dhur" min="0" placeholder="Dhur">
          </div>
        </div>

        <!-- Farming Scale -->
        <div class="form-group">
          <label for="scale">Farming Scale</label>
          <select id="scale" required>
            <option value="">Select Scale</option>
            <option value="small">Small Scale</option>
            <option value="medium">Medium Scale</option>
            <option value="large">Large Scale</option>
          </select>
        </div>

        <!-- Main Crops -->
        <div class="form-group">
          <label for="crops">Main Crops / Products</label>
          <input type="text" id="crops" placeholder="E.g. Sugarcane, Rice, Wheat, Vegetables, etc." required>
        </div>

        <!-- Terms and Conditions -->
        <div class="form-group" style="text-align: left; margin: 20px 0;">
          <div class="checkbox-wrapper">
            <input type="checkbox" id="terms" required>
            <label for="terms">I agree to the <abbr title="Click to view Terms & Conditions" onclick="window.open('../Terms_and_conditions/terms_and_conditions.html', '_blank')">Terms and Conditions</abbr></label>
          </div>
        </div>

        <!-- Submit -->
        <button type="submit" class="submit-btn">Submit Profile</button>
      </form>
    </div>

    <script>
      function submitForm() {
        // Get form values
        const name = document.getElementById('farmer-name').value;
        const phone = document.getElementById('phone').value;
        const email = document.getElementById('email').value;
        const crops = document.getElementById('crops').value;

        // Basic validation
        if (name.length < 3) {
          alert('Please enter a valid name (minimum 3 characters)');
          return false;
        }

        if (!phone.match(/^[9][6-8][0-9]{8}$/)) {
          alert('Please enter a valid Nepali phone number');
          return false;
        }

        if (!email.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)) {
          alert('Please enter a valid email address');
          return false;
        }

        if (crops.length < 3) {
          alert('Please enter valid crops/products');
          return false;
        }

        // If all validations pass, redirect to dashboard
        window.location.href = "../farmer_module/f_dashboard.html";
        return false;
      }

      async function getCurrentLocation(inputId) {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(async function(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            try {
              const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}`);
              const data = await response.json();

              if (data.address) {
                const { village, town, city, county, state, country } = data.address;
                const locationName = 
                  [village || town || city, county, state, country]
                  .filter(Boolean)
                  .join(", ");
                document.getElementById(inputId).value = locationName;
              } else {
                document.getElementById(inputId).value = "Location not found";
              }
            } catch (err) {
              alert("Error fetching location name.");
              console.error(err);
            }

          }, function(error) {
            alert("Unable to fetch location. Please allow location access.");
          });
        } else {
          alert("Geolocation is not supported by this browser.");
        }
      }

      document.getElementById('same-address').addEventListener('change', function() {
        const tempAddress = document.getElementById('temp-address');
        if (this.checked) {
            tempAddress.value = document.getElementById('address').value;
            tempAddress.readOnly = true;  // Use readOnly instead of disabled
        } else {
            tempAddress.readOnly = false;
            tempAddress.value = '';
        }
      });

      // Update the address copy when permanent address changes
      document.getElementById('address').addEventListener('input', function() {
        if (document.getElementById('same-address').checked) {
          document.getElementById('temp-address').value = this.value;
        }
      });
    </script>
</body>
</html>
              